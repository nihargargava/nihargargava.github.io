<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2025-10-29" />
  <title>Hecke integration formula</title>
  <style>
    code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        span.underline{text-decoration: underline;}
        div.column{display: inline-block; vertical-align: top; width: 50%;}
        div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
        ul.task-list{list-style: none;}
        div.csl-bib-body { }
        div.csl-entry {
          clear: both;
        }
        .hanging div.csl-entry {
          margin-left:2em;
          text-indent:-2em;
        }
        div.csl-left-margin {
          min-width:2em;
          float:left;
        }
        div.csl-right-inline {
          margin-left:2em;
          padding-left:1em;
        }
        div.csl-indent {
          margin-left: 2em;
        }  </style>
  <link rel="stylesheet" href="style.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Hecke integration formula</h1>
</header>
<nav id="TOC" role="doc-toc">
<h3 id="toc-title">Contents</h3>
<ul>
<li><a href="#heckes-trick" id="toc-heckes-trick">Hecke’s trick</a></li>
<li><a href="#bibliography" id="toc-bibliography">References</a></li>
</ul>
</nav>
$$

$$
<p>The following is an integration formula due to <a
href="hecke.html">Hecke</a> who used it to prove the analytic
continuation of <a href="dedekind_zeta.html">Dedekind zeta
function</a>.</p>
<p>Let <span class="math inline">\(E^*(\Lambda,z)\)</span> be the <a
href="epstein_zeta.html">completed Epstein zeta function</a> of a
lattice <span class="math inline">\(\Lambda \subseteq
\mathbb{R}^{n}\)</span>.</p>
<p>Let <span class="math inline">\(\zeta_K(s)\)</span> be the <a
href="dedekind_zeta.html">Dedekind zeta function</a> of a number field
<span class="math inline">\(K\)</span> of degree <span
class="math inline">\(n\)</span>. Then, the completed Dedekind zeta
function is defined as <span class="math display">\[\begin{equation}
\zeta_{K}^{*}(s) = \pi^{-\frac{s}{2}} \Gamma(\tfrac{s}{2})^{r_1}  \left(
(2 \pi)^{-s} \Gamma(s)\right)^{r_2} |\Delta_K|^{\frac{s}{2}} \zeta_K(s),
\end{equation}\]</span> where <span
class="math inline">\(\Delta_K\)</span> is the discriminant of the
number field <span class="math inline">\(K\)</span> and <span
class="math inline">\(r_1\)</span> is the number of real embeddings and
<span class="math inline">\(r_2\)</span> is the number of pairs of
complex embeddings.</p>
<p>Then, the following theorem is true.</p>
<div class="theorem">
<p> <strong>(Hecke)</strong></p>
<p>Identify <span class="math inline">\(K\otimes \mathbb{R} =
\mathbb{R}^{n} = \mathbb{R}^{r_1} \oplus \mathbb{C}^{r_2}\)</span>.</p>
<p>Consider the <a href="class_group.html">Arakelov class group</a>
<span class="math inline">\(\widetilde{\mathop{\mathrm{Cl}}}(K)\)</span>
and identify it as a collection of lattices in <span
class="math inline">\(\mathop{\mathrm{SL}}_{n}(\mathbb{R})/\mathop{\mathrm{SL}}_{n}(\mathbb{Z})\)</span>.
Then, the Hecke integration formula basically says that <span
class="math display">\[\begin{equation}
\int_{\widetilde{\mathop{\mathrm{Cl}}}(K)} E^{*}(\Lambda,ns) d\Lambda
= \frac{\omega_K}{2^{r_1} n R_K}  \zeta_K^{*}(s)
\end{equation}\]</span> Here <span
class="math inline">\(\omega_K\)</span> is the number of roots of unity
in <span class="math inline">\(K\)</span> and <span
class="math inline">\(R_K\)</span> is the <a
href="regulator.html">regulator</a> of <span
class="math inline">\(K\)</span>. The measure <span
class="math inline">\(d\Lambda\)</span> is with respect to a Haar
measure on <span
class="math inline">\(\widetilde{\mathop{\mathrm{Cl}}}(K)\)</span> that
makes every connected component of unit covolume.</p>
</div>
<p>The same theorem can also be done with <a
href="class_group_l_function.html">class group L functions</a>. See
<span class="citation" data-cites="K20">[<a href="#ref-K20"
role="doc-biblioref">1</a>]</span></p>
<p>Let us outline the proof of this theorem.</p>
<h1 id="heckes-trick">Hecke’s trick</h1>
<p>Let us reestablish the so-called “Hecke’s trick” <span
class="citation" data-cites="K20">[<a href="#ref-K20"
role="doc-biblioref">1</a>]</span>. This is the crucial step that
connects diagonal orbits to norms.</p>
<div class="lemma">
<p>{For <span class="math inline">\(\Re(s)&gt;1\)</span>} we have that
<span class="math display">\[\begin{align}
\int_{a \in \mathop{\mathrm{K_{\mathbb{R}}}}^{(1)}} \|av\|^{-sd}
\mathop{\mathrm{\, d^{\times}}}a
&amp; =  |\mathop{\mathrm{N}}(v)|^{-s} \cdot
{  \frac{(2 \pi )^{r_2} \Gamma(\tfrac{s}{2})^{r_1} \Gamma(s)^{r_2} }{
2^{sr_2} \cdot \frac{d}{2} \Gamma(\frac{sd}{2})  } }.
\end{align}\]</span></p>
</div>
<div class="proof">
<p>Let us prove it for <span class="math inline">\(v=1\)</span>.
Consider the integral <span class="math display">\[\begin{equation}
\label{eq:first_one}
  \int_{x \in \mathop{\mathrm{K_{\mathbb{R}}}}} e^{-\|x\|^{2}}
|\mathop{\mathrm{N}}(x)|^{s-1} \mathop{\mathrm{\, d}}x
  = \int_{x \in \mathop{\mathrm{K_{\mathbb{R}}}}^{\times}}
e^{-\|x\|^{2}}
|\mathop{\mathrm{N}}(x)|^{s}  |\mathop{\mathrm{N}}(x)|^{-1}\mathop{\mathrm{\,
d}}x.
\end{equation}\]</span> We can evaluate it two ways. One way is to write
the Haar measure on <span
class="math inline">\(|\mathop{\mathrm{N}}(x)|^{-1} \mathop{\mathrm{\,
d}}x\)</span> on <span
class="math inline">\(\mathop{\mathrm{K_{\mathbb{R}}}}^{\times}\)</span>
by writing <span class="math display">\[\begin{align}
    \mathop{\mathrm{K_{\mathbb{R}}}}^{\times}  &amp; \simeq
\mathbb{R}_{&gt;0} \times \mathop{\mathrm{K_{\mathbb{R}}}}^{(1)} \\
    x  &amp; = t \cdot a \\
    |\mathop{\mathrm{N}}(x)|^{-1} \mathop{\mathrm{\, d}}x &amp; =  \deg
K \cdot \left( \tfrac{1}{t}\mathop{\mathrm{\, d}}t  \right)\cdot
\mathop{\mathrm{\, d^{\times}}}a.
\end{align}\]</span> Observe then that for <span
class="math inline">\(d=\deg K\)</span> we have <span
class="math inline">\(\mathop{\mathrm{N}}(at)
=t^{d}\mathop{\mathrm{N}}(a)\)</span>. Hence, <span
class="math display">\[\begin{align}
  \int_{x \in \mathop{\mathrm{K_{\mathbb{R}}}}} e^{-\|x\|^{2}}
|\mathop{\mathrm{N}}(x)|^{s-1} \mathop{\mathrm{\, d}}x
  &amp; =
  \int_{t \in \mathbb{R}_{&gt;0}}\int_{a \in
\mathop{\mathrm{K_{\mathbb{R}}}}^{(1)}} e^{-t^2\|a\|^{2}} d t^{sd-1}
\mathop{\mathrm{\, d^{\times}}}a \mathop{\mathrm{\, d}}t .\\
  &amp; =
  \int_{t \in \mathbb{R}_{&gt;0}}e^{-t^2} d t^{sd-1} \mathop{\mathrm{\,
d}}t  \int_{a \in \mathop{\mathrm{K_{\mathbb{R}}}}^{(1)}} \|a\|^{-sd}
\mathop{\mathrm{\, d^{\times}}}a  \\
  &amp; =
  \tfrac{d}{2}\Gamma(\tfrac{sd}{2})
  \int_{a \in \mathop{\mathrm{K_{\mathbb{R}}}}^{(1)}}
\|a\|^{-sd}\mathop{\mathrm{\, d^{\times}}}a.
\end{align}\]</span> On the other hand, one can also write <span
class="math inline">\(x=(x_1,\dots,x_{r_1+r_2}) \in \mathbb{R}^{r_1}
\times \mathbb{C}^{r_2}\)</span>. <span
class="math display">\[\begin{align}
  \int_{x \in \mathop{\mathrm{K_{\mathbb{R}}}}} &amp;  e^{-\|x\|^{2}}
|\mathop{\mathrm{N}}(x)|^{s-1} \mathop{\mathrm{\, d}}x \\
  &amp; =
  \int_{x \in \mathop{\mathrm{K_{\mathbb{R}}}}} e^{-\left(
\sum_{i=1}^{r_1}|x_i|^{2} +2 \sum_{i=r_1+1}^{r_2}|x_i|^{2} \right)} |x_1
x_2 \dots x_{r_1}|^{s-1} |x_{r_1+1} \dots x_{r_1+r_2}|^{2( s-1 )}
\mathop{\mathrm{\, d}}x\\
  &amp; =
\prod_{i=1}^{r_1}\left( 2\int_{x \in {\mathbb{R}_{&gt; 0}} } e^{- x^{2}}
x^{s-1} \mathop{\mathrm{\, d}}x \right)
\prod_{i=r_1+1}^{r_1+r_2}\left( 2\cdot 2 \pi \int_{x \in
{\mathbb{R}_{&gt; 0}} } e^{- 2 x^{2}} x^{2(s-1)} x\mathop{\mathrm{\,
d}}x \right)\\
  &amp; =  (2\pi)^{r_2} 2^{-sr_2} \Gamma(\tfrac{s}{2})^{r_1}
\Gamma(s)^{r_2}.
\end{align}\]</span> The factor of <span
class="math inline">\(2\)</span> appearing before <span
class="math inline">\(2\pi\)</span> is a bit subtle.</p>
<p>For <span class="math inline">\(v \neq 1\)</span>, replace <span
class="math inline">\(x\)</span> with <span
class="math inline">\(xv\)</span> in the integral in the first equation
and follow the same process.</p>
</div>
<h1 class="unnumbered" id="bibliography">References</h1>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0"
role="list">
<div id="ref-K20" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">I.
Khayutin, Non-vanishing of class group <span>L</span>-functions for
number fields with a small regulator. <em>Compositio Mathematica</em>,
<strong>156</strong> (2020) 2423–2436.</div>
</div>
</div>
<hr />
	<small>	<p class="date">This page was updated on October 29, 2025.<br>
		<a href="index.html">Main Page</a> </p>
      </small>
</body>
</html>
